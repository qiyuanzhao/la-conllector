var WxParse = require('../../wxParse/wxParse.js');
const articleData = {
  title: '我是标题',
  author: '王小二',
  date: '2017-12-20',
  readNum: 111,
  likeNum: 22,
  content: `<div class="rich_media_content " id="js_content">
                    

                    

                    
                    
        <p style="line-height: 25.6px; white-space: normal;"><img data-type="gif" data-src="http://mmbiz.qpic.cn/mmbiz_gif/T4CVxWr67omOwNRvf47WjUAXvSkvWicRdNha34SjM3v29zcCAFYS3K2o5vicahDS2YWM3H8iaeD7KwVknY93Rgf3Q/0?wx_fmt=gif" class=" __bg_gif" data-ratio="0.33" data-w="600" src="https://mmbiz.qpic.cn/mmbiz_gif/T4CVxWr67omOwNRvf47WjUAXvSkvWicRdNha34SjM3v29zcCAFYS3K2o5vicahDS2YWM3H8iaeD7KwVknY93Rgf3Q/0?wx_fmt=gif&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" style="width: auto !important; height: auto !important; visibility: visible !important;" data-order="0" data-fail="0"></p><p style="line-height: 25.6px; white-space: normal;">一份高质量的excel报表，不仅仅是他的实用性、便捷性，美观也是非常重要的一部分。</p><p style="line-height: 25.6px; white-space: normal;"><br></p><p style="line-height: 25.6px; white-space: normal;">下载几个老外做的Excel表格，非常的漂亮：<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><p style="line-height: 25.6px; white-space: normal;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><p style="line-height: 25.6px; white-space: normal;"><img class="" data-ratio="0.8174603174603174" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_jpg/4jUToJBtQvSNG9J97LiaXKmy3iaKDVfia34gGBMRH8BPaoVLjGsqrb7GRv1x448lrYbvNKvTjrNVRdepd1SZU9QiaA/640?wx_fmt=jpeg" data-type="jpeg" data-w="504" width="auto" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: auto !important; height: auto !important;" _width="auto" src="https://mmbiz.qpic.cn/mmbiz_jpg/4jUToJBtQvSNG9J97LiaXKmy3iaKDVfia34gGBMRH8BPaoVLjGsqrb7GRv1x448lrYbvNKvTjrNVRdepd1SZU9QiaA/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img class="" data-ratio="0.6555772994129159" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_jpg/4jUToJBtQvSNG9J97LiaXKmy3iaKDVfia34F93dltCibicqoDHPzR4RWgicCicT46ohxlCjlWzLIkax2rcDpJicN9XD8jw/640?wx_fmt=jpeg" data-type="jpeg" data-w="511" width="auto" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: auto !important; height: auto !important;" _width="auto" src="https://mmbiz.qpic.cn/mmbiz_jpg/4jUToJBtQvSNG9J97LiaXKmy3iaKDVfia34F93dltCibicqoDHPzR4RWgicCicT46ohxlCjlWzLIkax2rcDpJicN9XD8jw/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">再看看我们最常见的表格，难看的瞬间爆表</p><p style="font-size: 16px; line-height: 25.6px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; line-height: 1.6; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="line-height: 25.6px; white-space: normal;"><img class="" data-ratio="0.6059544658493871" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_jpg/4jUToJBtQvSNG9J97LiaXKmy3iaKDVfia34DXZNE7YVcdYgwsYjzOs2lUFhEKkSwMqrUoZQ8bK8ZgtzFicSxrpwC3w/640?wx_fmt=jpeg" data-type="jpeg" data-w="571" width="auto" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: auto !important; height: auto !important;" _width="auto" src="https://mmbiz.qpic.cn/mmbiz_jpg/4jUToJBtQvSNG9J97LiaXKmy3iaKDVfia34DXZNE7YVcdYgwsYjzOs2lUFhEKkSwMqrUoZQ8bK8ZgtzFicSxrpwC3w/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"></p><p style="line-height: 25.6px; white-space: normal;">其实Excel漂亮并不意味着花梢，表格设计就是要<strong>突出和展示数据，</strong>达到这个目的，又能<strong>看上去很舒服，</strong>就是完美又好看的Excel表格。如何能做出漂亮的Excel呢？</p><p style="line-height: 25.6px; white-space: normal;"><br></p><p style="line-height: 25.6px; white-space: normal;"><img data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/T4CVxWr67onvn2znISIS73nbs4kQeVnHC62PBKcXWaibAHPX5Nv58evDeFPYYGYdL8IOTJTU1Rc8rX9WTiaGz3qg/0?wx_fmt=png" class="" data-ratio="0.41718043567612" data-w="2433" src="https://mmbiz.qpic.cn/mmbiz_png/T4CVxWr67onvn2znISIS73nbs4kQeVnHC62PBKcXWaibAHPX5Nv58evDeFPYYGYdL8IOTJTU1Rc8rX9WTiaGz3qg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" style="width: auto !important; height: auto !important; visibility: visible !important;" data-fail="0"></p><p style="line-height: 25.6px; white-space: normal;">&nbsp;</p><p style="line-height: 25.6px; white-space: normal;"><a href="http://mp.weixin.qq.com/s?__biz=MzAxODM2NzEyOA==&amp;mid=2654557432&amp;idx=8&amp;sn=4e94628e5c65ab56b2d52f9446453bef&amp;scene=21#wechat_redirect" target="_blank">点这里☞加入魔方学院，成为讲师</a><br></p><p style="line-height: 25.6px; white-space: normal;">&nbsp;&nbsp;<br></p><p style="line-height: 25.6px; white-space: normal;">课程结束后，你会得到：<br><br>&nbsp;&nbsp; 1. 报表好看人人赞<br><br>&nbsp;&nbsp; 2.零问题交付日报<br><br>&nbsp;&nbsp; 3.快速制作完成Excel表格<br>&nbsp; &nbsp;<br>&nbsp;&nbsp; 4.晋升主管的必备技能</p><p style="line-height: 25.6px; white-space: normal;"><br></p><section data-role="outer" label="Powered by 135editor.com" style="line-height: 25.6px; white-space: normal;"><section data-tools="135编辑器" data-id="86469"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="25"><section><section><section data-role="outer" label="Powered by 135editor.com" style="font-family: 微软雅黑; font-size: 16px;"><section class="" data-tools="135编辑器" data-id="63576" style="border: 0px none; box-sizing: border-box;"><section data-width="100%" style="margin: 10px; width: 556px; text-align: center;"><section style="margin-top: 10px; margin-bottom: -10px; margin-left: -0.14em; padding-top: 10px; padding-bottom: 15px; font-size: 1.3rem; letter-spacing: 0.14em; border-top-width: 3px; border-top-style: solid; border-top-color: rgb(33, 33, 34); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(198, 198, 199); box-sizing: border-box;"><strong><span style="color: rgb(12, 12, 11); font-size: 18px;">上课时间</span></strong></section><section style="margin-left: -5px; display: inline-block; border-left-width: 5px; border-left-style: solid; border-left-color: transparent; border-right-width: 5px; border-right-style: solid; border-right-color: transparent; border-top-width: 10px; border-top-style: solid; border-top-color: rgb(26, 26, 25); box-sizing: border-box;"><br></section></section></section></section></section></section></section></section></section></section></section></section><section class="" data-tools="135编辑器" data-id="23" style="line-height: 25.6px; white-space: normal;"><section class="" style="margin-top: 10px; margin-bottom: 10px; padding: 15px 20px 15px 45px; max-width: 100%; box-sizing: border-box; font-size: 14px; line-height: 22.39px; outline: none 0px; border: 0px none currentcolor; vertical-align: baseline; overflow-wrap: break-word !important; background-image: url(&quot;http://mmbiz.qpic.cn/mmbiz/yqVAqoZvDibHXI5ekoKR1icA9n2tIN2MafRz4ZMlbZ9VJIPyHVvA3622V9M4opp0KibWG6F78HdcHOABQbic1krfPw/0?wx_fmt=jpeg&quot;); background-color: rgb(241, 241, 241); background-position: 1% 5px; background-repeat: no-repeat;"><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="font-size: 16px;"><span style="max-width: 100%; color: rgb(255, 169, 0); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">7月27日&nbsp; 今晚8点</span></strong></span><span style="color: rgb(255, 169, 0); max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; color: rgb(63, 63, 63); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></strong><strong style="max-width: 100%; color: rgb(63, 63, 63); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></strong></span></span></p></section></section><p><br></p><p style="line-height: 25.6px; white-space: normal; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 15px;">1、课程时长为30分钟</span><br></p><p style="line-height: 25.6px; white-space: normal; text-align: center;"><span style="max-width: 100%; font-size: 15px; color: rgb(63, 63, 63); box-sizing: border-box !important; overflow-wrap: break-word !important;">2、录制视频形式</span></p><p style="line-height: 25.6px; white-space: normal; text-align: center;"><span style="max-width: 100%; font-size: 15px; color: rgb(63, 63, 63); box-sizing: border-box !important; overflow-wrap: break-word !important;">此次公开课为现场录制，线上播放</span></p><p style="line-height: 25.6px; white-space: normal;"><br></p><section data-role="outer" label="Powered by 135editor.com" style="line-height: 25.6px; white-space: normal;"><section data-tools="135编辑器" data-id="25"><section><section><section data-role="outer" label="Powered by 135editor.com" style="font-family: 微软雅黑; font-size: 16px;"><section class="" data-tools="135编辑器" data-id="63576" style="border: 0px none; box-sizing: border-box;"><section data-width="100%" style="margin: 10px; width: 556px; text-align: center;"><section style="margin-top: 10px; margin-bottom: -10px; margin-left: -0.14em; padding-top: 10px; padding-bottom: 15px; font-size: 1.3rem; letter-spacing: 0.14em; border-top-width: 3px; border-top-style: solid; border-top-color: rgb(33, 33, 34); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(198, 198, 199); box-sizing: border-box;"><strong><span style="color: rgb(12, 12, 11); font-size: 18px;">报名方式</span></strong><br></section><section style="margin-left: -5px; display: inline-block; border-left-width: 5px; border-left-style: solid; border-left-color: transparent; border-right-width: 5px; border-right-style: solid; border-right-color: transparent; border-top-width: 10px; border-top-style: solid; border-top-color: rgb(26, 26, 25); box-sizing: border-box;"></section></section></section></section></section></section></section><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="color: rgb(255, 169, 0);"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">扫描下方二维码&nbsp;</strong></span><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(255, 76, 0); box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></strong></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(136, 136, 136); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">（或点击阅读原文）</strong></span><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(255, 76, 0); box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></strong></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="color: rgb(255, 169, 0);"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">获取上课链接</strong></span></p><p style="text-align: center;"><img class="" data-ratio="1" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/T4CVxWr67okGjpYibmLGGf4IibziaMQ1ibYgicFFQib0fwRuTl7mPO9PsLCYHKe53eJryoUPichnTTYhX9GWns6ofLfJA/640?wx_fmt=png" data-type="png" data-w="280" style="visibility: visible !important; width: auto !important; height: auto !important;" _width="auto" src="https://mmbiz.qpic.cn/mmbiz_png/T4CVxWr67okGjpYibmLGGf4IibziaMQ1ibYgicFFQib0fwRuTl7mPO9PsLCYHKe53eJryoUPichnTTYhX9GWns6ofLfJA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"></p></section><section data-role="outer" label="Powered by 135editor.com" style="line-height: 25.6px; white-space: normal; max-width: 100%; font-family: 微软雅黑; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section class="" data-tools="135编辑器" data-id="87831" style="max-width: 100%; box-sizing: border-box; border-width: 0px; border-style: none; overflow-wrap: break-word !important;"><section class="" style="margin: 10px auto; max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section data-width="4em" class="" style="max-width: 100%; width: 4em; height: 4em; transform: rotate(0deg); box-sizing: border-box !important; overflow-wrap: break-word !important; background-image: url(&quot;http://mmbiz.qpic.cn/mmbiz_png/T4CVxWr67okicWJX51iaa337L7HyRhJrNiawDAKxhADFWjune3RaRNmzBKlwicENlMUbCI2uZkEibyuY8Nqfa2oQhFA/0?wx_fmt=png&quot;); background-size: 100%; background-repeat: no-repeat;"><p style="padding-top: 1.1em; max-width: 100%; min-height: 1em; text-align: center; font-style: italic; font-weight: bold; font-size: large; box-sizing: border-box !important; overflow-wrap: break-word !important;">Tips</p></section><section class="" data-style="text-indent: 2em;" style="margin-top: -38.8px; margin-left: 19.8px; padding: 20px; max-width: 100%; box-sizing: border-box; border-width: 1px; border-style: dashed; height: auto; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(12, 12, 12); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; text-indent: 2em; white-space: pre-wrap; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br></strong></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(12, 12, 12); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; text-indent: 2em; white-space: pre-wrap; box-sizing: border-box !important; overflow-wrap: break-word !important;">Q1：魔方学院微课是什么形式？在哪里听课呢？</strong></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(160, 160, 160); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">A：<span style="max-width: 100%; line-height: 28.4444px;">本期将采用视频形式，在千聊直播中进行。<span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">长按上面二维码获取上课链接。</span></span></span></p><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">Q2：本期课程收费吗？</span></strong></span></section><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(160, 160, 160); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">A：本次课程不收费，课程链接无密码。</span></section><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">Q3：老学员如何报名？</span></strong></span></section><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(160, 160, 160); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">A：老学员无需在公众号回复，直接按照报名流程操作即可。</span></p><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">Q4：课程能否回听？</span></strong><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></section><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(160, 160, 160); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">A：随时可以回听，课程链接不变!</span></p></section></section></section><section data-role="paragraph" class="" style="max-width: 100%; box-sizing: border-box; border-width: 0px; border-style: none; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="font-size: 14px;"></span></p><section data-role="paragraph" class="" style="max-width: 100%; box-sizing: border-box; border-width: 0px; border-style: none; overflow-wrap: break-word !important;"><p style="line-height: 1.75em;"><strong><span style="color: rgb(255, 76, 65); font-size: 18px;"><span style="max-width: 100%; font-size: 24px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">↙</span></strong></span>戳</span></strong><span style="color: rgb(255, 76, 65);"><strong style="font-size: 14px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">阅读原文</span></strong></span><span style="font-size: 14px;">获取上课链接</span></p></section></section></section>
    </div>`
};
const app = getApp();
Page({
  data: {
    article: articleData,
    parseContent: 'xxxxxx',
    relatedShopList:[]
  },
  onLoad: function(option) {
    console.log(option);
    const articleId = option.id;
    var that = this;
    this.loadAritcle(articleId, (data)=> {
        console.log(data);
        this.setData({ article: data });
        WxParse.wxParse('parseContent', 'html', data.content, that, 5);
        this.loadRelateShop(data.brandId)
    })
  },
  loadAritcle(id, callback) {
    wx.request({
      url: 'http://read.lavector.com/api/wsa/article/' + id,
      data: {},
      header: {
        'content-type': 'application/json' // 默认值
      },
      success: res => {
        callback(res.data)
      }
    });
  },
  loadRelateShop(brandId, callback) {
    const plaza = app.globalData.nearestPlaza
    wx.request({
      url: 'http://read.lavector.com/api/wsa/shop?brandId=' + brandId + '&plazaId=' + 1,
      data: {},
      header: {
        'content-type': 'application/json' // 默认值
      },
      success: res => {
        console.log(res);
        this.setData({relatedShopList: res.data});
      }
    });
  },
  tapRelateShop(e) {
    const articleId = e.currentTarget.dataset.shopId;
    wx.navigateTo({
      url: '/pages/shop/shop?id=' + articleId
    });
  }
});
